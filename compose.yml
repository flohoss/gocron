services:
  backend:
    build:
      context: .
      dockerfile: docker/Dockerfile.dev
    command: air -c .air.toml
    volumes:
      - ./:/app/
      - /var/run/docker.sock:/var/run/docker.sock
    environment:
      - TZ=Europe/Berlin
    ports:
      - 8156:8156

  sqlc:
    profiles: [install]
    image: sqlc/sqlc
    command: generate
    working_dir: /app
    volumes:
      - ./:/app

  templ:
    profiles: [install]
    image: ghcr.io/a-h/templ
    command: generate -watch
    working_dir: /app
    volumes:
      - ./:/app

  golang:
    profiles: [install]
    image: golang:${V_GOLANG:-1.23}-alpine
    working_dir: /app
    volumes:
      - .:/app/

  node:
    profiles: [install]
    image: node:${V_NODE:-lts}-alpine
    working_dir: /app
    volumes:
      - ./web:/app/
